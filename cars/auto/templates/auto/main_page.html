{% extends 'base.html' %}
{% load custom_tags %}

{% block content %}
<div class="container-fluid mt-4">
    <div class="row">
        <!-- Список автомобилей -->
        <div class="col-md-10">
            <h1>Список автомобилей</h1>

            <!-- Кнопки фильтрации -->
            <div class="mb-3">
                <button class="btn btn-outline-secondary btn-sm" onclick="showList('all')">Все авто</button>
                <button class="btn btn-outline-primary btn-sm" onclick="showList('tank')">По багажнику ↑</button>
                <button class="btn btn-outline-success btn-sm" onclick="showList('safe')">Безопасные</button>
                <button class="btn btn-outline-dark btn-sm" onclick="showList('4wd')">Полный привод (4WD)</button>
                <button class="btn btn-outline-info btn-sm" onclick="showList('auto_trans')">Автомат</button>
                <button class="btn btn-outline-warning btn-sm" onclick="showList('manual_trans')">Механика</button>
                <button class="btn btn-outline-info btn-sm" onclick="showList('prod_year')">По году выпуска ↓</button>
                <button class="btn btn-outline-danger btn-sm" onclick="showList('score')">По рейтингу (score) ↓</button>
                {% for category in categories %}
                    <button class="btn btn-outline-secondary btn-sm" onclick="showList('cat-{{ category.slug }}')">{{ category.title }}</button>
                {% endfor %}
            </div>

            <!-- Все авто -->
            <div id="list-all">
                <div class="row row-cols-1 row-cols-md-3 g-4">
                    {% for auto in autos %}
                        {% include 'auto/auto_card.html' with auto=auto %}
                    {% endfor %}
                </div>
            </div>

            <!-- По багажнику -->
            <div id="list-tank" style="display:none;">
                <div class="row row-cols-1 row-cols-md-3 g-4">
                    {% for auto in filtered_by_tank %}
                        {% include 'auto/auto_card.html' with auto=auto %}
                    {% endfor %}
                </div>
            </div>

            <!-- Безопасные -->
            <div id="list-safe" style="display:none;">
                <div class="row row-cols-1 row-cols-md-3 g-4">
                    {% for auto in safe %}
                        {% include 'auto/auto_card.html' with auto=auto %}
                    {% endfor %}
                </div>
            </div>

            <!-- Полный привод -->
            <div id="list-4wd" style="display:none;">
                <div class="row row-cols-1 row-cols-md-3 g-4">
                    {% for auto in 4WD %}
                        {% include 'auto/auto_card.html' with auto=auto %}
                    {% endfor %}
                </div>
            </div>

            <!-- Автомат -->
            <div id="list-auto_trans" style="display:none;">
                <div class="row row-cols-1 row-cols-md-3 g-4">
                    {% for auto in automatic_transmission %}
                        {% include 'auto/auto_card.html' with auto=auto %}
                    {% endfor %}
                </div>
            </div>

            <!-- Механика -->
            <div id="list-manual_trans" style="display:none;">
                <div class="row row-cols-1 row-cols-md-3 g-4">
                    {% for auto in manual_transmission %}
                        {% include 'auto/auto_card.html' with auto=auto %}
                    {% endfor %}
                </div>
            </div>

            <!-- По году выпуска -->
            <div id="list-prod_year" style="display:none;">
                <div class="row row-cols-1 row-cols-md-3 g-4">
                    {% for auto in production_year %}
                        {% include 'auto/auto_card.html' with auto=auto %}
                    {% endfor %}
                </div>
            </div>

            <!-- По рейтингу -->
            <div id="list-score" style="display:none;">
                <div class="row row-cols-1 row-cols-md-3 g-4">
                    {% for auto in score %}
                        {% include 'auto/auto_card.html' with auto=auto %}
                    {% endfor %}
                </div>
            </div>

            <!-- По категориям -->
            {% for category in categories %}
            <div id="list-cat-{{ category.slug }}" style="display:none;">
                <div class="row row-cols-1 row-cols-md-3 g-4">
                    {% for auto in category_autos|get_item:category.slug %}
                        {% include 'auto/auto_card.html' with auto=auto %}
                    {% endfor %}
                </div>
            </div>
            {% endfor %}

        </div>

        <!-- Меню категорий -->
        <div class="col-md-2 bg-light border rounded shadow-sm p-3">
            <h5>Категории</h5>
            <ul class="nav flex-column">
                {% for category in categories %}
                    <li class="nav-item mb-1">
                        <a href="{% url 'category_auto' category.slug %}" class="btn btn-secondary w-100">{{ category.title }}</a>
                    </li>
                {% endfor %}
            </ul>
        </div>
    </div>
</div>

<script>
function showList(list) {
    const blocks = ['all', 'tank', 'safe', '4wd', 'auto_trans', 'manual_trans', 'prod_year', 'score'];
    {% for category in categories %}
        blocks.push('cat-{{ category.slug }}');
    {% endfor %}

    blocks.forEach(b => {
        document.getElementById('list-' + b).style.display = (list === b) ? 'block' : 'none';
    });
}
</script>
{% endblock %}